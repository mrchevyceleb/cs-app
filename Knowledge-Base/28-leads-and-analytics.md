# Leads and Analytics

## Overview

R-Link includes a comprehensive lead capture and analytics system that enables users to collect attendee information during live sessions (meetings, webinars, and live streams) and analyze engagement data afterward. Leads are managed through the **Leads** admin tab (`/admin?tab=leads`) via the `LeadsTab` component. The system supports lead scoring, AI-powered tagging, CRM synchronization, and CSV data export.

Lead data is stored in two Base44 entities: `LeadSubmission` (individual lead records with form data and engagement metrics) and `LeadCapture` (lead capture form configurations that define which fields to collect). Leads are associated with rooms and sessions, allowing account owners to track which events generate the most valuable prospects.

---

## Lead Submission Entity

The `LeadSubmission` entity stores each captured lead with the following fields:

| Field | Type | Description |
|---|---|---|
| `id` | string | Unique identifier |
| `room_id` | string | The room where the lead was captured |
| `lead_capture_id` | string | Reference to the `LeadCapture` form configuration used |
| `form_data` | object | Submitted form fields (see below) |
| `form_data.name` | string | Attendee's name |
| `form_data.email` | string | Attendee's email address |
| `form_data.phone` | string | Attendee's phone number |
| `form_data.company` | string | Attendee's company/organization |
| `ai_qualification_score` | number | AI-assigned lead score (0-100) |
| `engagement_score` | number | Engagement-based lead score (0-100) |
| `ai_tags` | array | AI-generated tags (e.g., "decision_maker", "high_intent") |
| `time_in_session` | number | Time spent in session (seconds) |
| `reactions_count` | number | Number of reactions sent during session |
| `questions_asked` | number | Number of questions asked during session |
| `location` | object | Geolocation data |
| `location.city` | string | City name |
| `location.country` | string | Country name |
| `crm_synced` | boolean | Whether this lead has been synced to a CRM |
| `crm_synced_at` | string | ISO timestamp of CRM sync |
| `created_date` | string | ISO timestamp of lead creation |

---

## LeadCapture Entity

The `LeadCapture` entity defines the configuration of lead capture forms:

| Field | Type | Description |
|---|---|---|
| `id` | string | Unique identifier |
| `name` | string | Form name (e.g., "Webinar Registration Form") |
| `fields` | array | List of form fields to display |
| `room_id` | string | Associated room |

Lead capture forms are displayed during sessions via the `LeadCaptureModal` / `LeadCaptureRenderer` components.

---

## LeadsTab Interface

### Accessing the Leads Tab

1. Navigate to **Admin** > **Leads** in the sidebar.
2. This tab is permission-gated (requires appropriate role permissions).

### Props Received

| Prop | Type | Description |
|---|---|---|
| `accountId` | string | The current account's ID, used to filter leads by account rooms |

### UI Layout

The LeadsTab displays:

1. **Header**: Title ("Leads"), lead count with filter status, and an **Export CSV** button.
2. **Filter Panel**: Search bar, score filter dropdown, tag filter dropdown, sort controls.
3. **Leads List**: Expandable lead cards showing contact info, scores, tags, and engagement metrics.

---

## Lead Capture During Sessions

Lead capture occurs during live sessions when attendees interact with lead capture forms:

### How Lead Capture Works

1. The host or room configuration activates a lead capture form during a session.
2. The `LeadCaptureModal` displays to attendees, requesting information (name, email, phone, company, etc.).
3. The attendee submits the form, creating a `LeadSubmission` entity.
4. The system automatically tracks engagement metrics (time in session, reactions, questions) and updates the lead record.
5. AI scoring and tagging are applied to the lead based on engagement and form data.

### Lead Capture Trigger Points

Lead capture forms can be triggered:
- At session join (pre-entry gate)
- During the session (pop-up form)
- Via event landing page registration (pre-event capture)

---

## Lead Scoring System

R-Link uses a dual-scoring system for leads:

### AI Qualification Score (`ai_qualification_score`)

- Range: 0-100
- Generated by AI analysis of the lead's form data and behavior
- Considers factors like company size, role/title, engagement patterns
- Updated as more engagement data becomes available

### Engagement Score (`engagement_score`)

- Range: 0-100
- Calculated from in-session behavior:
  - **Time in session**: Longer attendance increases score
  - **Reactions count**: Active participants score higher
  - **Questions asked**: Engaged attendees who ask questions score higher

### Score Categories

The LeadsTab categorizes leads into three tiers based on the higher of the two scores:

| Category | Score Range | Badge Color | Description |
|---|---|---|---|
| **Hot** | 80-100 | Red | High-value leads likely to convert |
| **Warm** | 50-79 | Orange | Interested leads that need nurturing |
| **Cold** | 0-49 | Blue | Low-engagement leads for long-term follow-up |

---

## AI Tagging

The `ai_tags` field contains an array of AI-generated labels applied to each lead. Tags are used for:

- **Segmentation**: Group leads by shared characteristics
- **Filtering**: Use the tag filter dropdown in the LeadsTab to find specific lead segments
- **CRM enrichment**: Tags are included in CRM sync data

Example tags: `"decision_maker"`, `"high_intent"`, `"technical_user"`, `"marketing_lead"`, `"enterprise"`, `"smb"`.

Tags are displayed as purple-outlined badges next to the lead name in the lead list.

---

## Searching and Filtering Leads

### Search

The search bar filters leads by:
- **Name** (`form_data.name`)
- **Email** (`form_data.email`)
- **Company** (`form_data.company`)

Search is case-insensitive and matches partial strings.

### Score Filter

| Filter Option | Score Criteria |
|---|---|
| All Scores | No filter |
| Hot (80+) | Score >= 80 |
| Warm (50-79) | Score >= 50 and < 80 |
| Cold (<50) | Score < 50 |

### Tag Filter

Dynamically populated from all unique `ai_tags` across the lead dataset. Select a tag to show only leads with that specific tag.

### Sorting

Leads can be sorted by:

| Sort Option | Field | Description |
|---|---|---|
| **Date** (default) | `created_date` | When the lead was captured |
| **Score** | `ai_qualification_score` or `engagement_score` | Lead quality score |
| **Time in Session** | `time_in_session` | Duration of session attendance |

Sort direction toggles between ascending and descending via the sort order button.

---

## Lead Detail View

Clicking on a lead card expands it to show detailed information:

### Engagement Metrics Panel (4-column grid)

| Metric | Icon Color | Description |
|---|---|---|
| **Score** | Purple | AI qualification or engagement score (0-100) |
| **Time** | Blue | Time in session displayed in minutes |
| **Reactions** | Green | Number of reactions sent |
| **Questions** | Orange | Number of questions asked |

### Form Data Panel

Displays all key-value pairs from `form_data`, with keys formatted as human-readable labels (underscores replaced with spaces, capitalized).

### Source Information

- **Form**: The name of the `LeadCapture` form used
- **Session**: The room name where the lead was captured
- **Location**: City and country (if geolocation data is available)

### CRM Sync Status

If the lead has been synced to a CRM:
- Green "Synced to CRM" badge
- Timestamp of the sync (`crm_synced_at`)

---

## Lead Data Export

### Exporting to CSV

1. Click the **Export CSV** button in the Leads header.
2. The system generates a CSV file containing all currently filtered leads.
3. The file downloads automatically with the name `leads-YYYY-MM-DD.csv`.

### CSV Columns

| Column | Source |
|---|---|
| Date | `created_date` (formatted as `YYYY-MM-DD HH:mm`) |
| Name | `form_data.name` |
| Email | `form_data.email` |
| Phone | `form_data.phone` |
| Company | `form_data.company` |
| Score | `ai_qualification_score` or `engagement_score` |
| Tags | `ai_tags` (semicolon-separated) |
| Time in Session | `time_in_session` (seconds) |
| Reactions | `reactions_count` |
| Questions | `questions_asked` |
| Form | Lead capture form name |
| Session | Room name |

**Note:** The export respects current filters. If you have a search query, score filter, or tag filter active, only matching leads are exported.

CSV fields containing commas, quotes, or newlines are properly escaped.

---

## Integration with CRM Tools

R-Link supports lead synchronization with the following CRM platforms (via the Integrations tab):

| CRM Platform | Plan Required | Description |
|---|---|---|
| **Salesforce** | Business | Enterprise CRM with full lead object mapping |
| **HubSpot** | Business | Inbound marketing and CRM platform |
| **Marketo** | Business | Marketing automation platform |
| **ActiveCampaign** | Business | Email marketing and CRM automation |
| **ConvertKit** | Business | Creator-focused email and lead management |
| **Go High Level** | Business | All-in-one marketing and CRM platform |

### CRM Sync Indicators

- Leads that have been synced display a green "Synced to CRM" badge in the detail view.
- The `crm_synced` boolean field tracks sync status.
- The `crm_synced_at` timestamp records when the sync occurred.

### Setting Up CRM Integration

1. Navigate to **Admin** > **Integrations** tab.
2. Find your CRM platform in the CRM category.
3. Click **Connect** and provide API credentials.
4. Configure field mapping between R-Link lead data and CRM fields.
5. Enable automatic sync or perform manual exports.

---

## Analytics Dashboards

Lead analytics are integrated into the broader R-Link analytics ecosystem:

### Lead-Level Analytics

Available in the expanded lead detail view:
- Individual engagement score
- Time in session
- Reactions count
- Questions asked count
- Geographic location data

### Session-Level Analytics

Available via the Dashboard tab:
- Total attendees per session
- Lead conversion rates by event
- Top-performing rooms and sessions

### Aggregate Metrics

The Leads tab header shows:
- Total lead count (with filter status)
- Distribution across Hot/Warm/Cold categories (via filter)

---

## Settings and Options

| Setting | Location | Description |
|---|---|---|
| Lead capture form fields | LeadCapture entity / room configuration | Define which fields to collect from attendees |
| Score filter | Leads tab filter panel | Filter by Hot (80+), Warm (50-79), or Cold (<50) |
| Tag filter | Leads tab filter panel | Filter by AI-assigned tags |
| Sort order | Leads tab filter panel | Sort by Date, Score, or Time in Session (ascending/descending) |
| CSV export | Leads tab header | Export filtered leads to CSV file |
| CRM integration | Integrations tab | Connect CRM platforms for lead sync |

---

## Troubleshooting

| Issue | Cause | Solution |
|---|---|---|
| "No leads found" message | No lead submissions exist for the account's rooms | Ensure lead capture forms are configured and activated in your rooms |
| Leads not appearing after session | Query cache not refreshed | Refresh the page; leads are fetched from `LeadSubmission.list()` |
| Lead score shows 0 | Neither AI qualification nor engagement scoring has run | AI scoring processes asynchronously; allow time for scoring to complete |
| CSV export downloads empty file | All leads are filtered out by current search/filter | Clear all filters before exporting, or adjust filter criteria |
| CRM sync not showing | CRM integration not configured or sync pending | Check Integrations tab for CRM connection status; verify API credentials |
| Lead form data appears empty | Attendee submitted the form without filling fields | The form only requires email in most configurations; other fields may be optional |
| Tags not populating | AI tagging has not processed the lead | AI tagging runs asynchronously; tags may appear after a delay |
| Search not finding a lead | Search only matches name, email, and company | Use exact spelling or partial matches in those three fields only |
| "Loading leads..." spinner persists | Network issue or API timeout | Check network connectivity; refresh the page |
| Leads from wrong sessions appearing | Room filtering by account_id | The system filters leads by rooms belonging to the current account; verify room ownership |

---

## FAQ

**Q: How are leads captured during a session?**
A: Lead capture forms (configured via `LeadCapture` entities) are displayed to attendees during sessions. When attendees submit the form, a `LeadSubmission` record is created with their form data and engagement metrics.

**Q: What is the difference between AI qualification score and engagement score?**
A: The AI qualification score is generated by AI analysis of the lead's profile and behavior patterns. The engagement score is calculated from measurable session activity (time, reactions, questions). The system uses whichever score is available, with `ai_qualification_score` taking priority.

**Q: Can I manually edit lead scores?**
A: The current LeadsTab is read-only for lead data. Scores are automatically calculated and cannot be manually adjusted through the UI.

**Q: How do I set up lead capture for my sessions?**
A: Lead capture forms are configured at the room level. When creating or editing a room, you can attach a lead capture form that will display to attendees during sessions.

**Q: Does the CSV export include all leads or just filtered ones?**
A: The export includes only the currently filtered leads. If you want all leads, clear all search and filter criteria before exporting.

**Q: How often is lead data updated?**
A: Lead submission data is captured in real-time during sessions. AI scoring and tagging may be processed asynchronously with a short delay.

**Q: Can I delete a lead?**
A: The LeadsTab does not provide a delete function in the current UI. Lead management operations beyond viewing and exporting require direct entity manipulation or CRM tools.

**Q: What happens to leads if I disconnect my CRM integration?**
A: Leads that have already been synced remain in the CRM. The `crm_synced` flag on the R-Link side is not affected. New leads will not sync until the integration is reconnected.

---

## Known Limitations

1. **Read-only interface**: The LeadsTab is a viewing and export interface only. Leads cannot be edited, deleted, or manually scored from the admin UI.
2. **No real-time updates**: The leads list does not auto-refresh. Users must manually reload the page to see new leads captured during an active session.
3. **AI scoring delay**: AI qualification scores and tags are processed asynchronously and may not appear immediately after lead capture.
4. **Limited search fields**: Search only matches against `name`, `email`, and `company` fields from `form_data`. Other form fields are not searchable.
5. **No lead deduplication**: If the same attendee submits lead forms in multiple sessions, separate lead records are created without automatic deduplication.
6. **CRM sync is one-directional**: Lead data flows from R-Link to CRM tools. Changes made in the CRM are not reflected back in R-Link.
7. **Geographic data availability**: Location data (`city`, `country`) depends on geolocation services and may not be available for all leads.

---

## Plan Requirements

| Feature | Basic | Business |
|---|---|---|
| Leads Tab Access | Yes | Yes |
| Lead Capture During Sessions | Yes | Yes |
| Lead Scoring | Yes | Yes |
| AI Tagging | Yes | Yes |
| CSV Export | Yes | Yes |
| CRM Integration (Salesforce, HubSpot, etc.) | No | Yes |
| Advanced Analytics | No | Yes |

---

## Related Documents

- [01-platform-overview.md](./01-platform-overview.md) -- Platform architecture and entity model
- [20-integrations.md](./20-integrations.md) -- Integration setup overview
- [23-crm-integrations.md](./23-crm-integrations.md) -- CRM integration details (Salesforce, HubSpot, etc.)
- [29-event-landing-pages.md](./29-event-landing-pages.md) -- Event landing pages with registration forms
- [32-admin-dashboard-reference.md](./32-admin-dashboard-reference.md) -- Complete admin tab reference
